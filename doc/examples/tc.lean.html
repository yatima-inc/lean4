<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>A Certified Type Checker</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Lean4 v4.0.0-unknown. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.<br>Hover-Settings: Show types:<input id="toggleswitch" type="checkbox" onClick="toggleShowTypes(this);"> Show goals:<input id="toggleswitch" type="checkbox" onClick="toggleShowGoals(this);" checked><br></div><div class="document" id="a-certified-type-checker">
<h1 class="title">A Certified Type Checker</h1>

<p>In this example, we build a certified type checker for a simple expression
language.</p>
<p>Remark: this example is based on an example in the book [Certified Programming with Dependent Types](<a class="reference external" href="http://adam.chlipala.net/cpdt/">http://adam.chlipala.net/cpdt/</a>) by Adam Chlipala.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">where</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Nat ‚Üí _root_.Expr</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token">  : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>_root_.Expr ‚Üí _root_.Expr ‚Üí _root_.Expr</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>Bool ‚Üí _root_.Expr</span></span></div></blockquote></div></small></div>bool</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Bool</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Bool</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>_root_.Expr ‚Üí _root_.Expr ‚Üí _root_.Expr</span></span></div></blockquote></div></small></div>and</div><div class="alectryon-token">  : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Expr</span></div><div class="alectryon-token"></div></span></pre><p>We define a simple language of types using the inductive datatype <code class="highlight coq"><span class="n">Ty</span></code>, and
its typing rules using the inductive predicate <code class="highlight coq"><span class="n">HasType</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">where</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>_root_.Ty</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>_root_.Ty</span></span></div></blockquote></div></small></div>bool</div><div class="alectryon-token">
  </div><div class="alectryon-token"><span class="k">deriving</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>DecidableEq</var><b>: </b><span>Sort u ‚Üí Sort (max 1 u)</span></span></div></blockquote></div></small></div>DecidableEq</div><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div>HasType</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Prop</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="kt">Prop</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>‚àÄ {v : Nat}, _root_.HasType (Expr.nat v) Ty.nat</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token">  : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Nat ‚Üí Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>‚àÄ {a b : Expr}, _root_.HasType a Ty.nat ‚Üí _root_.HasType b Ty.nat ‚Üí _root_.HasType (Expr.plus a b) Ty.nat</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.plus</var><b>: </b><span>Expr ‚Üí Expr ‚Üí Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>plus</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>‚àÄ {v : Bool}, _root_.HasType (Expr.bool v) Ty.bool</span></span></div></blockquote></div></small></div>bool</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Bool ‚Üí Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Bool</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>‚àÄ {a b : Expr}, _root_.HasType a Ty.bool ‚Üí _root_.HasType b Ty.bool ‚Üí _root_.HasType (Expr.and a b) Ty.bool</span></span></div></blockquote></div></small></div>and</div><div class="alectryon-token">  : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">HasType</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.and</var><b>: </b><span>Expr ‚Üí Expr ‚Üí Expr</span></span></div></blockquote></div></small></div><span class="bp">.</span>and</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"></div></span></pre><p>We can easily show that if <code class="highlight coq"><span class="n">e</span></code> has type <code class="highlight coq"><span class="n">t‚ÇÅ</span></code> and type <code class="highlight coq"><span class="n">t‚ÇÇ</span></code>, then <code class="highlight coq"><span class="n">t‚ÇÅ</span></code> and <code class="highlight coq"><span class="n">t‚ÇÇ</span></code> must be equal
by using the the <code class="highlight coq"><span class="n">cases</span></code> tactic. This tactic creates a new subgoal for every constructor,
and automatically discharges unreachable cases. The tactic combinator <code class="highlight coq"><span class="n">tac‚ÇÅ</span> <span class="o">&lt;;&gt;</span> <span class="n">tac‚ÇÇ</span></code> applies
<code class="highlight coq"><span class="n">tac‚ÇÇ</span></code> to each subgoal produced by <code class="highlight coq"><span class="n">tac‚ÇÅ</span></code>. Then, the tactic <code class="highlight coq"><span class="n">rfl</span></code> is used to close all produced
goals using reflexivity.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType.det</var><b>: </b><span>‚àÄ {e : Expr} {t‚ÇÅ t‚ÇÇ : Ty}, HasType e t‚ÇÅ ‚Üí HasType e t‚ÇÇ ‚Üí t‚ÇÅ = t‚ÇÇ</span></span></div></blockquote></div></small></div>HasType.det</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType e t‚ÇÅ</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div>HasType</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t‚ÇÅ</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t‚ÇÅ</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType e t‚ÇÇ</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div>HasType</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t‚ÇÇ</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t‚ÇÇ</span></div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t‚ÇÅ</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t‚ÇÅ</span></div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t‚ÇÇ</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t‚ÇÇ</span></div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk0"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>t‚ÇÅ, t‚ÇÇ</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e t‚ÇÅ</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType e t‚ÇÇ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">t‚ÇÅ <span class="bp">=</span> t‚ÇÇ</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1"><div class="alectryon-token"><span class="k">cases</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType e t‚ÇÅ</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t‚ÇÇ</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>v‚úù</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType (Expr.nat v<span class="bp">‚úù</span>) t‚ÇÇ</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">nat</span></span><div class="goal-conclusion">Ty.nat <span class="bp">=</span> t‚ÇÇ</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t‚ÇÇ</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a‚úù¬≤, b‚úù</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType (Expr.plus a<span class="bp">‚úù¬≤</span> b<span class="bp">‚úù</span>) t‚ÇÇ</span></span></span><br></div><label class="goal-separator" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2"><hr><span class="goal-name">plus</span></label><div class="goal-conclusion">Ty.nat <span class="bp">=</span> t‚ÇÇ</div></blockquote><input class="alectryon-extra-goal-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t‚ÇÇ</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>v‚úù</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType (Expr.bool v<span class="bp">‚úù</span>) t‚ÇÇ</span></span></span><br></div><label class="goal-separator" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk3"><hr><span class="goal-name">bool</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> t‚ÇÇ</div></blockquote><input class="alectryon-extra-goal-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t‚ÇÇ</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a‚úù¬≤, b‚úù</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType (Expr.and a<span class="bp">‚úù¬≤</span> b<span class="bp">‚úù</span>) t‚ÇÇ</span></span></span><br></div><label class="goal-separator" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk4"><hr><span class="goal-name">and</span></label><div class="goal-conclusion">Ty.bool <span class="bp">=</span> t‚ÇÇ</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk5"><div class="alectryon-token"><span class="k">&lt;;&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>t‚ÇÅ, t‚ÇÇ</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e t‚ÇÅ</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType e t‚ÇÇ</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">t‚ÇÅ <span class="bp">=</span> t‚ÇÇ</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk6"><div class="alectryon-token"><span class="k">cases</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType (Expr.nat v‚úù) t‚ÇÇ</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr><span class="goal-name">nat.nat</span></span><div class="goal-conclusion">Ty.nat <span class="bp">=</span> Ty.nat</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk7"><div class="alectryon-token"><span class="k">&lt;;&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>t‚ÇÇ</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a‚úù¬≤, b‚úù</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType (Expr.and a<span class="bp">‚úù¬≤</span> b<span class="bp">‚úù</span>) t‚ÇÇ</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and</span></span><div class="goal-conclusion">Ty.bool <span class="bp">=</span> t‚ÇÇ</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk8"><div class="alectryon-token"><span class="k">rfl</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">üêô</span></div></blockquote></div></div></small></span></pre><p>The inductive type <code class="highlight coq"><span class="n">Maybe</span> <span class="n">p</span></code> has two contructors: <code class="highlight coq"><span class="n">found</span> <span class="n">a</span> <span class="n">h</span></code> and <code class="highlight coq"><span class="n">unknown</span></code>.
The former contains an element <code class="highlight coq"><span class="n">a</span> <span class="o">:</span> <span class="n">Œ±</span></code> and a proof that <code class="highlight coq"><span class="n">a</span></code> satisfies the predicate <code class="highlight coq"><span class="n">p</span></code>.
The constructor <code class="highlight coq"><span class="n">unknown</span></code> is used to encode &quot;failure&quot;.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Maybe</var><b>: </b><span>{Œ± : Sort u_1} ‚Üí (Œ± ‚Üí Prop) ‚Üí Sort (max 1 u_1)</span></span></div></blockquote></div></small></div>Maybe</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Œ± ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Œ±</var><b>: </b><span>Sort u_1</span></span></div></blockquote></div></small></div><span class="nv">Œ±</span></div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Prop</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="kt">Prop</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><span class="k">where</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>found</var><b>: </b><span>{Œ± : Sort u_1} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí _root_.Maybe p</span></span></div></blockquote></div></small></div>found</div><div class="alectryon-token"> : (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Œ±</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Œ±</var><b>: </b><span>Sort u_1</span></span></div></blockquote></div></small></div><span class="nv">Œ±</span></div><div class="alectryon-token">) <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Œ± ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Œ±</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> <span class="bp">‚Üí</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Maybe</var><b>: </b><span>{Œ± : Sort u_1} ‚Üí (Œ± ‚Üí Prop) ‚Üí Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Maybe</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Œ± ‚Üí Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>unknown</var><b>: </b><span>{Œ± : Sort u_1} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí _root_.Maybe p</span></span></div></blockquote></div></small></div>unknown</div><div class="alectryon-token"></div></span></pre><p>We define a notation for <code class="highlight coq"><span class="n">Maybe</span></code> that is similar to the builtin notation for the Lean builtin type <code class="highlight coq"><span class="n">Subtype</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">notation</span></div><div class="alectryon-token"> <span class="s2">&quot;{{ &quot;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>x</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">x</span></div><div class="alectryon-token"> <span class="s2">&quot; | &quot;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> <span class="s2">&quot; }}&quot;</span> <span class="bp">=&gt;</span> Maybe (</div><div class="alectryon-token"><span class="k">fun</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>x</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">x</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token">)</div></span></pre><p>The function <code class="highlight coq"><span class="n">Expr</span><span class="o">.</span><span class="n">typeCheck</span> <span class="n">e</span></code> returns a type <code class="highlight coq"><span class="n">ty</span></code> and a proof that <code class="highlight coq"><span class="n">e</span></code> has type <code class="highlight coq"><span class="n">ty</span></code>,
or <code class="highlight coq"><span class="n">unknown</span></code>.
Recall that, <code class="highlight coq"><span class="n">def</span> <span class="n">Expr</span><span class="o">.</span><span class="n">typeCheck</span> <span class="o">...</span></code> in Lean is notation for <code class="highlight coq"><span class="n">namespace</span> <span class="n">Expr</span> <span class="n">def</span> <span class="n">typeCheck</span> <span class="o">...</span> <span class="kr">end</span> <span class="n">Expr</span></code>.
The term <code class="highlight coq"><span class="o">.</span><span class="n">found</span> <span class="o">.</span><span class="n">nat</span> <span class="o">.</span><span class="n">nat</span></code> is sugar for <code class="highlight coq"><span class="n">Maybe</span><span class="o">.</span><span class="n">found</span> <span class="n">Ty</span><span class="o">.</span><span class="n">nat</span> <span class="n">HasType</span><span class="o">.</span><span class="n">nat</span></code>. Lean can infer the namespaces using
the expected types.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div>Expr.typeCheck</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</div><div class="alectryon-token">) : {{ </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"> <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div>HasType</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"> }} :=
  </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Nat ‚Üí Expr</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token"> <span class="bp">..</span>   <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>‚àÄ {v : Nat}, HasType (nat v) Ty.nat</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bool</var><b>: </b><span>Bool ‚Üí Expr</span></span></div></blockquote></div></small></div>bool</div><div class="alectryon-token"> <span class="bp">..</span>  <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>‚àÄ {v : Bool}, HasType (bool v) Ty.bool</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>Expr ‚Üí Expr ‚Üí Expr</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span>
    </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.plus</var><b>: </b><span>‚àÄ {a b : Expr}, HasType a Ty.nat ‚Üí HasType b Ty.nat ‚Üí HasType (plus a b) Ty.nat</span></span></div></blockquote></div></small></div><span class="bp">.</span>plus</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token">)
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>_</var><b>: </b><span>Maybe fun ty =&gt; HasType a ty</span></span></div></blockquote></div></small></div>_</div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>_</var><b>: </b><span>Maybe fun ty =&gt; HasType b ty</span></span></div></blockquote></div></small></div>_</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>and</var><b>: </b><span>Expr ‚Üí Expr ‚Üí Expr</span></span></div></blockquote></div></small></div>and</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span>
    </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">typeCheck</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.bool</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>bool</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.and</var><b>: </b><span>‚àÄ {a b : Expr}, HasType a Ty.bool ‚Üí HasType b Ty.bool ‚Üí HasType (and a b) Ty.bool</span></span></div></blockquote></div></small></div><span class="bp">.</span>and</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token">)
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>_</var><b>: </b><span>Maybe fun ty =&gt; HasType a ty</span></span></div></blockquote></div></small></div>_</div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>_</var><b>: </b><span>Maybe fun ty =&gt; HasType b ty</span></span></div></blockquote></div></small></div>_</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</div><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck_correct</var><b>: </b><span>‚àÄ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty ‚Üí typeCheck e ‚â† Maybe.unknown ‚Üí typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>Expr.typeCheck_correct</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div>HasType</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>typeCheck e ‚â† Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div>typeCheck</div><div class="alectryon-token"> <span class="bp">‚â†</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{Œ± : Sort ?u.4895} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div>typeCheck</div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk9"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>typeCheck e <span class="bp">‚â†</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">typeCheck e <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chka"><div class="alectryon-token"><span class="k">revert</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>typeCheck e ‚â† Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">typeCheck e <span class="bp">‚â†</span> Maybe.unknown <span class="bp">‚Üí</span> typeCheck e <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkb"><div class="alectryon-token"><span class="k">cases</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div>typeCheck</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>x‚úù</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType e ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x<span class="bp">‚úù</span> <span class="bp">‚â†</span> Maybe.unknown <span class="bp">‚Üí</span> x<span class="bp">‚úù</span> <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkc"><div class="alectryon-token"><span class="bp">|</span> found ty&#39; h&#39; <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>ty'</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>HasType e ty&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty&#39; h&#39; <span class="bp">‚â†</span> Maybe.unknown <span class="bp">‚Üí</span> Maybe.found ty&#39; h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkd"><div class="alectryon-token"><span class="k">intro</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>ty'</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>HasType e ty&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty&#39; h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chke"><div class="alectryon-token"><span class="k">have</span></div><div class="alectryon-token"> := </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType.det</var><b>: </b><span>‚àÄ {e : Expr} {t‚ÇÅ t‚ÇÇ : Ty}, HasType e t‚ÇÅ ‚Üí HasType e t‚ÇÇ ‚Üí t‚ÇÅ = t‚ÇÇ</span></span></div></blockquote></div></small></div>HasType.det</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType e ty</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h'</var><b>: </b><span>HasType e ty'</span></span></div></blockquote></div></small></div><span class="nv">h&#39;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br><span><var>ty'</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h'</var><span class="hyp-type"><b>: </b><span>HasType e ty&#39;</span></span></span><br><span><var>this</var><span class="hyp-type"><b>: </b><span>ty <span class="bp">=</span> ty&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty&#39; h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chkf"><div class="alectryon-token"><span class="k">subst</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>this</var><b>: </b><span>ty = ty'</span></span></div></blockquote></div></small></div><span class="k">this</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ, h'</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">found</span></span><div class="goal-conclusion">Maybe.found ty h&#39; <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk10"><div class="alectryon-token"><span class="k">rfl</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">üêô</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk11"><div class="alectryon-token"><span class="bp">|</span> unknown <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">unknown</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">‚â†</span> Maybe.unknown <span class="bp">‚Üí</span> Maybe.unknown <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk12"><div class="alectryon-token"><span class="k">intros</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>h, h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType e ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">unknown</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.found ty h</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk13"><div class="alectryon-token"><span class="k">contradiction</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">üêô</span></div></blockquote></div></div></small></span></pre><p>Now, we prove that if <code class="highlight coq"><span class="n">Expr</span><span class="o">.</span><span class="n">typeCheck</span> <span class="n">e</span></code> returns <code class="highlight coq"><span class="n">Maybe</span><span class="o">.</span><span class="n">unknown</span></code>, then forall <code class="highlight coq"><span class="n">ty</span></code>, <code class="highlight coq"><span class="n">HasType</span> <span class="n">e</span> <span class="n">ty</span></code> does not hold.
The notation <code class="highlight coq"><span class="n">e</span><span class="o">.</span><span class="n">typeCheck</span></code> is sugar for <code class="highlight coq"><span class="n">Expr</span><span class="o">.</span><span class="n">typeCheck</span> <span class="n">e</span></code>. Lean can infer this because we explicitly said that <code class="highlight coq"><span class="n">e</span></code> has type <code class="highlight coq"><span class="n">Expr</span></code>.
The proof is by induction on <code class="highlight coq"><span class="n">e</span></code> and case analysis. The tactic <code class="highlight coq"><span class="n">rename_i</span></code> is used to to rename &quot;inaccessible&quot; variables.
We say a variable is inaccessible if it is introduced by a tactic (e.g., <code class="highlight coq"><span class="n">cases</span></code>) or has been shadowed by another variable introduced
by the user. Note that the tactic <code class="highlight coq"><span class="n">simp</span> <span class="o">[</span><span class="n">typeCheck</span><span class="o">]</span></code> is applied to all goal generated by the <code class="highlight coq"><span class="nb">induction</span></code> tactic, and closes
the cases corresponding to the constructors <code class="highlight coq"><span class="n">Expr</span><span class="o">.</span><span class="n">nat</span></code> and <code class="highlight coq"><span class="n">Expr</span><span class="o">.</span><span class="n">bool</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck_complete</var><b>: </b><span>‚àÄ {ty : Ty} {e : Expr}, typeCheck e = Maybe.unknown ‚Üí ¬¨HasType e ty</span></span></div></blockquote></div></small></div>Expr.typeCheck_complete</div><div class="alectryon-token"> {</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</div><div class="alectryon-token">} : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div>typeCheck</div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</div><div class="alectryon-token"> <span class="bp">‚Üí</span> <span class="bp">¬¨</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div>HasType</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk14"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">typeCheck e <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType e ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk15"><div class="alectryon-token"><span class="k">induction</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">typeCheck e <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType e ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk16"><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token"> [</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div>typeCheck</div><div class="alectryon-token">]</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and</span></span><div class="goal-conclusion">(<span class="k">match</span> typeCheck a, typeCheck b <span class="k">with</span>
    <span class="bp">|</span> Maybe.found Ty.bool h‚ÇÅ, Maybe.found Ty.bool h‚ÇÇ <span class="bp">=&gt;</span> Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool)
    <span class="bp">|</span> x, x_1 <span class="bp">=&gt;</span> Maybe.unknown) <span class="bp">=</span>
    Maybe.unknown <span class="bp">‚Üí</span>
  <span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk17"><div class="alectryon-token"><span class="bp">|</span> plus a b iha ihb <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus</span></span><div class="goal-conclusion">(<span class="k">match</span> typeCheck a, typeCheck b <span class="k">with</span>
    <span class="bp">|</span> Maybe.found Ty.nat h‚ÇÅ, Maybe.found Ty.nat h‚ÇÇ <span class="bp">=&gt;</span> Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat)
    <span class="bp">|</span> x, x_1 <span class="bp">=&gt;</span> Maybe.unknown) <span class="bp">=</span>
    Maybe.unknown <span class="bp">‚Üí</span>
  <span class="bp">¬¨</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk18"><div class="alectryon-token"><span class="k">split</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>h‚ÇÅ‚úù</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h‚ÇÇ‚úù</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat) <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (plus a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬≤</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br></div><label class="goal-separator" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk19"><hr><span class="goal-name">plus.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (plus a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1a"><div class="alectryon-token"><span class="k">next</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>h‚ÇÅ‚úù</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h‚ÇÇ‚úù</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat) <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (plus a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬≤</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br></div><label class="goal-separator" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1b"><hr><span class="goal-name">plus.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (plus a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1c"><div class="alectryon-token"><span class="k">intros</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>h‚ÇÅ‚úù</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h‚ÇÇ‚úù</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br><span><var>h‚úù¬π</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÅ<span class="bp">‚úù</span></span></span></span><br><span><var>h‚úù</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÇ<span class="bp">‚úù</span></span></span></span><br><span><var>a‚úù</var><span class="hyp-type"><b>: </b><span>Maybe.found Ty.nat (_ : HasType (plus a b) Ty.nat) <span class="bp">=</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="bp">¬¨</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1d"><div class="alectryon-token"><span class="k">contradiction</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">üêô</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1e"><div class="alectryon-token"><span class="k">next</span></div><div class="alectryon-token"> ra rb hnp <span class="bp">=&gt;</span> <span class="c1">-- Recall that hnp is a hypothesis generated by the `split` tactic that asserts the previous case was not taken</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬≤</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_2</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (plus a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk1f"><div class="alectryon-token"><span class="k">intro</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Maybe.unknown = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (plus a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">‚àÄ</span> (h‚ÇÅ : HasType a Ty.nat) (h‚ÇÇ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÅ <span class="bp">‚Üí</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÇ <span class="bp">‚Üí</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (plus a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk20"><div class="alectryon-token"><span class="k">cases</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (plus a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">‚àÄ</span> (h‚ÇÅ : HasType a Ty.nat) (h‚ÇÇ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÅ <span class="bp">‚Üí</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÇ <span class="bp">‚Üí</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (plus a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk21"><div class="alectryon-token"><span class="bp">|</span> plus h‚ÇÅ h‚ÇÇ <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">‚àÄ</span> (h‚ÇÅ : HasType a Ty.nat) (h‚ÇÇ : HasType b Ty.nat),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÅ <span class="bp">‚Üí</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.nat h‚ÇÇ <span class="bp">‚Üí</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType a Ty.nat</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType b Ty.nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a Ty.nat</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b Ty.nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus</span></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk22"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hnp</var><b>: </b><span>‚àÄ (h‚ÇÅ : HasType a Ty.nat) (h‚ÇÇ : HasType b Ty.nat),
  typeCheck a = Maybe.found Ty.nat h‚ÇÅ ‚Üí typeCheck b = Maybe.found Ty.nat h‚ÇÇ ‚Üí False</span></span></div></blockquote></div></small></div><span class="nv">hnp</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>‚àÄ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty ‚Üí typeCheck e ‚â† Maybe.unknown ‚Üí typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>typeCheck a = Maybe.unknown ‚Üí ¬¨HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">iha</span></div><div class="alectryon-token"> <span class="bp">¬∑</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token">)) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>‚àÄ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty ‚Üí typeCheck e ‚â† Maybe.unknown ‚Üí typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>typeCheck b = Maybe.unknown ‚Üí ¬¨HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></div><div class="alectryon-token"> <span class="bp">¬∑</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.nat</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token">))</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">üêô</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk23"><div class="alectryon-token"><span class="bp">|</span> and a b iha ihb <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and</span></span><div class="goal-conclusion">(<span class="k">match</span> typeCheck a, typeCheck b <span class="k">with</span>
    <span class="bp">|</span> Maybe.found Ty.bool h‚ÇÅ, Maybe.found Ty.bool h‚ÇÇ <span class="bp">=&gt;</span> Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool)
    <span class="bp">|</span> x, x_1 <span class="bp">=&gt;</span> Maybe.unknown) <span class="bp">=</span>
    Maybe.unknown <span class="bp">‚Üí</span>
  <span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk24"><div class="alectryon-token"><span class="k">split</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>h‚ÇÅ‚úù</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h‚ÇÇ‚úù</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool) <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬≤</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br></div><label class="goal-separator" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk25"><hr><span class="goal-name">and.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk26"><div class="alectryon-token"><span class="k">next</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>h‚ÇÅ‚úù</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h‚ÇÇ‚úù</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and.h_1</span></span><div class="goal-conclusion">Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool) <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk27" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬≤</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br></div><label class="goal-separator" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk27"><hr><span class="goal-name">and.h_2</span></label><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk28"><div class="alectryon-token"><span class="k">intros</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>h‚ÇÅ‚úù</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h‚ÇÇ‚úù</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br><span><var>h‚úù¬π</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÅ<span class="bp">‚úù</span></span></span></span><br><span><var>h‚úù</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÇ<span class="bp">‚úù</span></span></span></span><br><span><var>a‚úù</var><span class="hyp-type"><b>: </b><span>Maybe.found Ty.bool (_ : HasType (and a b) Ty.bool) <span class="bp">=</span> Maybe.unknown</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk29"><div class="alectryon-token"><span class="k">contradiction</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">üêô</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2a"><div class="alectryon-token"><span class="k">next</span></div><div class="alectryon-token"> ra rb hnp <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>x‚úù¬≤</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>x‚úù¬π</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and.h_2</span></span><div class="goal-conclusion">Maybe.unknown <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType (and a b) ty</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2b"><div class="alectryon-token"><span class="k">intro</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Maybe.unknown = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (and a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">‚àÄ</span> (h‚ÇÅ : HasType a Ty.bool) (h‚ÇÇ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÅ <span class="bp">‚Üí</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÇ <span class="bp">‚Üí</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (and a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2c"><div class="alectryon-token"><span class="k">cases</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType (and a b) ty</span></span></div></blockquote></div></small></div><span class="nv">ht</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a ty</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b ty</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">‚àÄ</span> (h‚ÇÅ : HasType a Ty.bool) (h‚ÇÇ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÅ <span class="bp">‚Üí</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÇ <span class="bp">‚Üí</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>ht</var><span class="hyp-type"><b>: </b><span>HasType (and a b) ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2d"><div class="alectryon-token"><span class="bp">|</span> and h‚ÇÅ h‚ÇÇ <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Expr</span></span></span><br><span><var>ra</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType a ty</span></span></span><br><span><var>rb</var><span class="hyp-type"><b>: </b><span>Maybe <span class="k">fun</span> ty <span class="bp">=&gt;</span> HasType b ty</span></span></span><br><span><var>hnp</var><span class="hyp-type"><b>: </b><span><span class="bp">‚àÄ</span> (h‚ÇÅ : HasType a Ty.bool) (h‚ÇÇ : HasType b Ty.bool),
  typeCheck a <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÅ <span class="bp">‚Üí</span> typeCheck b <span class="bp">=</span> Maybe.found Ty.bool h‚ÇÇ <span class="bp">‚Üí</span> False</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>Maybe.unknown <span class="bp">=</span> Maybe.unknown</span></span></span><br><span><var>h‚ÇÅ</var><span class="hyp-type"><b>: </b><span>HasType a Ty.bool</span></span></span><br><span><var>h‚ÇÇ</var><span class="hyp-type"><b>: </b><span>HasType b Ty.bool</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span>typeCheck a <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType a Ty.bool</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span>typeCheck b <span class="bp">=</span> Maybe.unknown <span class="bp">‚Üí</span> <span class="bp">¬¨</span>HasType b Ty.bool</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">and</span></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="kn1pymns5yrim07rpvldv8v8a2vw697m-tc-lean-chk2e"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hnp</var><b>: </b><span>‚àÄ (h‚ÇÅ : HasType a Ty.bool) (h‚ÇÇ : HasType b Ty.bool),
  typeCheck a = Maybe.found Ty.bool h‚ÇÅ ‚Üí typeCheck b = Maybe.found Ty.bool h‚ÇÇ ‚Üí False</span></span></div></blockquote></div></small></div><span class="nv">hnp</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>‚àÄ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty ‚Üí typeCheck e ‚â† Maybe.unknown ‚Üí typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>typeCheck a = Maybe.unknown ‚Üí ¬¨HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">iha</span></div><div class="alectryon-token"> <span class="bp">¬∑</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÅ</var><b>: </b><span>HasType a Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÅ</span></div><div class="alectryon-token">)) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck_correct</var><b>: </b><span>‚àÄ {e : Expr} {ty : Ty} {h : HasType e ty}, HasType e ty ‚Üí typeCheck e ‚â† Maybe.unknown ‚Üí typeCheck e = Maybe.found ty h</span></span></div></blockquote></div></small></div>typeCheck_correct</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>typeCheck b = Maybe.unknown ‚Üí ¬¨HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></div><div class="alectryon-token"> <span class="bp">¬∑</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h‚ÇÇ</var><b>: </b><span>HasType b Ty.bool</span></span></div></blockquote></div></small></div><span class="nv">h‚ÇÇ</span></div><div class="alectryon-token">))</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">üêô</span></div></blockquote></div></div></small></span></pre><p>Finally, we show that type checking for <code class="highlight coq"><span class="n">e</span></code> can be decided using <code class="highlight coq"><span class="n">Expr</span><span class="o">.</span><span class="n">typeCheck</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>instance</var><b>: </b><span>(e : Expr) ‚Üí (t : Ty) ‚Üí Decidable (HasType e t)</span></span></div></blockquote></div></small></div><span class="kd">instance</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Expr</div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Decidable</var><b>: </b><span>Prop ‚Üí Type</span></span></div></blockquote></div></small></div>Decidable</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType</var><b>: </b><span>Expr ‚Üí Ty ‚Üí Prop</span></span></div></blockquote></div></small></div>HasType</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token">) :=
  </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h'</var><b>: </b><span>Expr.typeCheck e = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h&#39;</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Expr</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>typeCheck</var><b>: </b><span>(e : Expr) ‚Üí Maybe fun ty =&gt; HasType e ty</span></span></div></blockquote></div></small></div>typeCheck</div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.found</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí (a : Œ±) ‚Üí p a ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>found</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t'</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht'</var><b>: </b><span>HasType e t'</span></span></div></blockquote></div></small></div><span class="nv">ht&#39;</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span>
    </div><div class="alectryon-token"><span class="k">if</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>heq</var><b>: </b><span>¬¨t = t'</span></span></div></blockquote></div></small></div><span class="nv">heq</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t'</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">t&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">then</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>isTrue</var><b>: </b><span>{p : Prop} ‚Üí p ‚Üí Decidable p</span></span></div></blockquote></div></small></div>isTrue</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>heq</var><b>: </b><span>t = t'</span></span></div></blockquote></div></small></div><span class="nv">heq</span></div><div class="alectryon-token"> <span class="bp">‚ñ∏</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht'</var><b>: </b><span>HasType e t'</span></span></div></blockquote></div></small></div><span class="nv">ht&#39;</span></div><div class="alectryon-token">)
    </div><div class="alectryon-token"><span class="k">else</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>isFalse</var><b>: </b><span>{p : Prop} ‚Üí ¬¨p ‚Üí Decidable p</span></span></div></blockquote></div></small></div>isFalse</div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">fun</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType e t</span></span></div></blockquote></div></small></div><span class="nv">ht</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>heq</var><b>: </b><span>¬¨t = t'</span></span></div></blockquote></div></small></div><span class="nv">heq</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HasType.det</var><b>: </b><span>‚àÄ {e : Expr} {t‚ÇÅ t‚ÇÇ : Ty}, HasType e t‚ÇÅ ‚Üí HasType e t‚ÇÇ ‚Üí t‚ÇÅ = t‚ÇÇ</span></span></div></blockquote></div></small></div>HasType.det</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht</var><b>: </b><span>HasType e t</span></span></div></blockquote></div></small></div><span class="nv">ht</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ht'</var><b>: </b><span>HasType e t'</span></span></div></blockquote></div></small></div><span class="nv">ht&#39;</span></div><div class="alectryon-token">)
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.unknown</var><b>: </b><span>{Œ± : Type} ‚Üí {p : Œ± ‚Üí Prop} ‚Üí Maybe p</span></span></div></blockquote></div></small></div><span class="bp">.</span>unknown</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>isFalse</var><b>: </b><span>{p : Prop} ‚Üí ¬¨p ‚Üí Decidable p</span></span></div></blockquote></div></small></div>isFalse</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Expr.typeCheck_complete</var><b>: </b><span>‚àÄ {ty : Ty} {e : Expr}, Expr.typeCheck e = Maybe.unknown ‚Üí ¬¨HasType e ty</span></span></div></blockquote></div></small></div>Expr.typeCheck_complete</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h'</var><b>: </b><span>Expr.typeCheck e = Maybe.unknown</span></span></div></blockquote></div></small></div><span class="nv">h&#39;</span></div><div class="alectryon-token">)</div></span></pre>
</div>
</div></body>
</html>
