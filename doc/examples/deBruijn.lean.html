<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Dependent de Bruijn Indices</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Lean4 v4.0.0-unknown. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+↑</kbd> <kbd>Ctrl+↓</kbd> to navigate, <kbd>Ctrl+🖱️</kbd> to focus. On Mac, use <kbd>⌘</kbd> instead of <kbd>Ctrl</kbd>.<br>Hover-Settings: Show types:<input id="toggleswitch" type="checkbox" onClick="toggleShowTypes(this);"> Show goals:<input id="toggleswitch" type="checkbox" onClick="toggleShowGoals(this);" checked><br></div><div class="document" id="dependent-de-bruijn-indices">
<h1 class="title">Dependent de Bruijn Indices</h1>

<p>In this example, we represent program syntax terms in a type family parameterized by a list of types,
representing the typing context, or information on which free variables are in scope and what
their types are.</p>
<p>Remark: this example is based on an example in the book [Certified Programming with Dependent Types](<a class="reference external" href="http://adam.chlipala.net/cpdt/">http://adam.chlipala.net/cpdt/</a>) by Adam Chlipala.</p>
<p>Programmers who move to statically typed functional languages from scripting languages
often complain about the requirement that every element of a list have the same type. With
fancy type systems, we can partially lift this requirement. We can index a list type with a
“type-level” list that explains what type each element of the list should have. This has been
done in a variety of ways in Haskell using type classes, and we can do it much more cleanly
and directly in Lean.</p>
<p>We parameterize our heterogeneous lists by at type <code class="highlight coq"><span class="n">α</span></code> and an <code class="highlight coq"><span class="n">α</span></code>-indexed type <code class="highlight coq"><span class="n">β</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HList</var><b>: </b><span>{α : Type v} → (α → Type u) → List α → Type (max u v)</span></span></div></blockquote></div></small></div>HList</div><div class="alectryon-token"> {</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>α</var><b>: </b><span>Type v</span></span></div></blockquote></div></small></div><span class="nv">α</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type v</var><b>: </b><span>Type (v + 1)</span></span></div></blockquote></div></small></div><span class="kt">Type</span> v</div><div class="alectryon-token">} (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>β</var><b>: </b><span>α → Type u</span></span></div></blockquote></div></small></div><span class="nv">β</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>α</var><b>: </b><span>Type v</span></span></div></blockquote></div></small></div><span class="nv">α</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type u</var><b>: </b><span>Type (u + 1)</span></span></div></blockquote></div></small></div><span class="kt">Type</span> u</div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type v → Type v</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>α</var><b>: </b><span>Type v</span></span></div></blockquote></div></small></div><span class="nv">α</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type (max u v)</var><b>: </b><span>Type ((max u v) + 1)</span></span></div></blockquote></div></small></div><span class="kt">Type</span> (max u v)</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nil</var><b>: </b><span>{α : Type v} → {β : α → Type u} → _root_.HList β []</span></span></div></blockquote></div></small></div>nil</div><div class="alectryon-token">  : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HList</var><b>: </b><span>{α : Type v} → (α → Type u) → List α → Type (max u v)</span></span></div></blockquote></div></small></div><span class="nv">HList</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>β</var><b>: </b><span>α → Type u</span></span></div></blockquote></div></small></div><span class="nv">β</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>[]</var><b>: </b><span>List α</span></span></div></blockquote></div></small></div>[]</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>cons</var><b>: </b><span>{α : Type v} → {β : α → Type u} → {i : α} → {is : List α} → β i → _root_.HList β is → _root_.HList β (i :: is)</span></span></div></blockquote></div></small></div>cons</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>β</var><b>: </b><span>α → Type u</span></span></div></blockquote></div></small></div><span class="nv">β</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>i</var><b>: </b><span>α</span></span></div></blockquote></div></small></div><span class="nv">i</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HList</var><b>: </b><span>{α : Type v} → (α → Type u) → List α → Type (max u v)</span></span></div></blockquote></div></small></div><span class="nv">HList</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>β</var><b>: </b><span>α → Type u</span></span></div></blockquote></div></small></div><span class="nv">β</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>is</var><b>: </b><span>List α</span></span></div></blockquote></div></small></div><span class="nv">is</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HList</var><b>: </b><span>{α : Type v} → (α → Type u) → List α → Type (max u v)</span></span></div></blockquote></div></small></div><span class="nv">HList</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>β</var><b>: </b><span>α → Type u</span></span></div></blockquote></div></small></div><span class="nv">β</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>i</var><b>: </b><span>α</span></span></div></blockquote></div></small></div><span class="nv">i</span></div><div class="alectryon-token">::</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>is</var><b>: </b><span>List α</span></span></div></blockquote></div></small></div><span class="nv">is</span></div><div class="alectryon-token">)</div></span></pre><p>We overload the <code class="highlight coq"><span class="n">List</span><span class="o">.</span><span class="n">cons</span></code> notation <code class="highlight coq"><span class="o">::</span></code> so we can also use it to create
heterogeneous lists.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">infix</span></div><div class="alectryon-token">:<span class="mi">67</span> <span class="s2">&quot; :: &quot;</span> <span class="bp">=&gt;</span> HList.cons</div></span></pre><p>We similarly overload the <code class="highlight coq"><span class="n">List</span></code> notation <code class="highlight coq"><span class="o">[]</span></code> for the empty heterogeneous list.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">notation</span></div><div class="alectryon-token"> <span class="s2">&quot;[&quot;</span> <span class="s2">&quot;]&quot;</span> <span class="bp">=&gt;</span> HList.nil</div></span></pre><p>Variables are represented in a way isomorphic to the natural numbers, where
number 0 represents the first element in the context, number 1 the second element, and so
on. Actually, instead of numbers, we use the <code class="highlight coq"><span class="n">Member</span></code> inductive family.</p>
<p>The value of type <code class="highlight coq"><span class="n">Member</span> <span class="n">a</span> <span class="kr">as</span></code> can be viewed as a certificate that <code class="highlight coq"><span class="n">a</span></code> is
an element of the list <code class="highlight coq"><span class="kr">as</span></code>. The constructor <code class="highlight coq"><span class="n">Member</span><span class="o">.</span><span class="n">head</span></code> says that <code class="highlight coq"><span class="n">a</span></code>
is in the list if the list begins with it. The constructor <code class="highlight coq"><span class="n">Member</span><span class="o">.</span><span class="n">tail</span></code>
says that if <code class="highlight coq"><span class="n">a</span></code> is in the list <code class="highlight coq"><span class="n">bs</span></code>, it is also in the list <code class="highlight coq"><span class="n">b</span><span class="o">::</span><span class="n">bs</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Member</var><b>: </b><span>{α : Type u_1} → α → List α → Type u_1</span></span></div></blockquote></div></small></div>Member</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>α</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">α</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type u_1 → Type u_1</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>α</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">α</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type _</var><b>: </b><span>Type (_tmp_ind_univ_param + 1)</span></span></div></blockquote></div></small></div><span class="kt">Type</span> _</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>head</var><b>: </b><span>{x : Type u_1} → {a : x} → {as : List x} → _root_.Member a (a :: as)</span></span></div></blockquote></div></small></div>head</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Member</var><b>: </b><span>{α : Type u_1} → α → List α → Type _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Member</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>?m.2214</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>?m.2214</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token">::</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>as</var><b>: </b><span>List ?m.2214</span></span></div></blockquote></div></small></div><span class="nv">as</span></div><div class="alectryon-token">)
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>tail</var><b>: </b><span>{x : Type u_1} → {a : x} → {bs : List x} → {b : x} → _root_.Member a bs → _root_.Member a (b :: bs)</span></span></div></blockquote></div></small></div>tail</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Member</var><b>: </b><span>{α : Type u_1} → α → List α → Type _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Member</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>?m.2351</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bs</var><b>: </b><span>List ?m.2351</span></span></div></blockquote></div></small></div><span class="nv">bs</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Member</var><b>: </b><span>{α : Type u_1} → α → List α → Type _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Member</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>?m.2351</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>?m.2351</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">::</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bs</var><b>: </b><span>List ?m.2351</span></span></div></blockquote></div></small></div><span class="nv">bs</span></div><div class="alectryon-token">)</div></span></pre><p>Given a heterogeneous list <code class="highlight coq"><span class="n">HList</span> <span class="n">β</span> <span class="kr">is</span></code> and value of type <code class="highlight coq"><span class="n">Member</span> <span class="n">i</span> <span class="kr">is</span></code>, <code class="highlight coq"><span class="n">HList</span><span class="o">.</span><span class="n">get</span></code>
retrieves an element of type <code class="highlight coq"><span class="n">β</span> <span class="n">i</span></code> from the list.
The pattern <code class="highlight coq"><span class="o">.</span><span class="n">head</span></code> and <code class="highlight coq"><span class="o">.</span><span class="n">tail</span> <span class="n">h</span></code> are sugar for <code class="highlight coq"><span class="n">Member</span><span class="o">.</span><span class="n">head</span></code> and <code class="highlight coq"><span class="n">Member</span><span class="o">.</span><span class="n">tail</span> <span class="n">h</span></code> respectively.
Lean can infer the namespace using the expected type.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HList.get</var><b>: </b><span>{x : Type u_1} → {β : x → Type u_2} → {is : List x} → {i : x} → HList β is → Member i is → β i</span></span></div></blockquote></div></small></div>HList.get</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HList</var><b>: </b><span>{α : Type u_1} → (α → Type u_2) → List α → Type (max u_2 u_1)</span></span></div></blockquote></div></small></div>HList</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>β</var><b>: </b><span>?m.2950 → Type u_2</span></span></div></blockquote></div></small></div><span class="nv">β</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>is</var><b>: </b><span>List ?m.2950</span></span></div></blockquote></div></small></div><span class="nv">is</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Member</var><b>: </b><span>{α : Type u_1} → α → List α → Type u_1</span></span></div></blockquote></div></small></div>Member</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>i</var><b>: </b><span>?m.2950</span></span></div></blockquote></div></small></div><span class="nv">i</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>is</var><b>: </b><span>List ?m.2950</span></span></div></blockquote></div></small></div><span class="nv">is</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>β</var><b>: </b><span>?m.2950 → Type u_2</span></span></div></blockquote></div></small></div><span class="nv">β</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>i</var><b>: </b><span>?m.2950</span></span></div></blockquote></div></small></div><span class="nv">i</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>β i</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token">::</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>as</var><b>: </b><span>HList β ?m.3482</span></span></div></blockquote></div></small></div><span class="nv">as</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.head</var><b>: </b><span>{x : Type u_1} → {a : x} → {as : List x} → Member a (a :: as)</span></span></div></blockquote></div></small></div><span class="bp">.</span>head</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>β i</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>β ?m.3603</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token">::</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>as</var><b>: </b><span>HList β ?m.3604</span></span></div></blockquote></div></small></div><span class="nv">as</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.tail</var><b>: </b><span>{x : Type u_1} → {a : x} → {bs : List x} → {b : x} → Member a bs → Member a (b :: bs)</span></span></div></blockquote></div></small></div><span class="bp">.</span>tail</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Member i ?m.3604</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>as</var><b>: </b><span>HList β x✝</span></span></div></blockquote></div></small></div><span class="nv">as</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>get</var><b>: </b><span>{x : Type u_1} → {β : x → Type u_2} → {is : List x} → {i : x} → HList β is → Member i is → β i</span></span></div></blockquote></div></small></div><span class="nv">get</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Member i x✝</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"></div></span></pre><p>Here is the definition of the simple type system for our programming language, a simply typed
lambda calculus with natural numbers as the base type.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">where</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>_root_.Ty</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>fn</var><b>: </b><span>_root_.Ty → _root_.Ty → _root_.Ty</span></span></div></blockquote></div></small></div>fn</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Ty</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Ty</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Ty</span></div><div class="alectryon-token"></div></span></pre><p>We can write a function to translate <code class="highlight coq"><span class="n">Ty</span></code> values to a Lean type
— remember that types are first class, so can be calculated just like any other value.
We mark <code class="highlight coq"><span class="n">Ty</span><span class="o">.</span><span class="n">denote</span></code> as <code class="highlight coq"><span class="o">[</span><span class="n">reducible</span><span class="o">]</span></code> to make sure the typeclass resolution procedure can
unfold/reduce it. For example, suppose Lean is trying to synthesize a value for the instance
<code class="highlight coq"><span class="kn">Add</span> <span class="o">(</span><span class="n">Ty</span><span class="o">.</span><span class="n">denote</span> <span class="n">Ty</span><span class="o">.</span><span class="n">nat</span><span class="o">)</span></code>. Since <code class="highlight coq"><span class="n">Ty</span><span class="o">.</span><span class="n">denote</span></code> is marked as <code class="highlight coq"><span class="o">[</span><span class="n">reducible</span><span class="o">],</span>
<span class="n">the</span> <span class="n">typeclass</span> <span class="n">resolution</span> <span class="n">procedure</span> <span class="n">can</span> <span class="n">reduce</span> <span class="o">`</span><span class="n">Ty</span><span class="o">.</span><span class="n">denote</span> <span class="n">Ty</span><span class="o">.</span><span class="n">nat</span></code> to <code class="highlight coq"><span class="n">Nat</span></code>, and use
the builtin instance for <code class="highlight coq"><span class="kn">Add</span> <span class="n">Nat</span></code> as the solution.</p>
<p>Recall that the term <code class="highlight coq"><span class="n">a</span><span class="o">.</span><span class="n">denote</span></code> is sugar for <code class="highlight coq"><span class="n">denote</span> <span class="n">a</span></code> where <code class="highlight coq"><span class="n">denote</span></code> is the function being defined.
We call it the &quot;dot notation&quot;.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">@[reducible]</span> </div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty.denote</var><b>: </b><span>Ty → Type</span></span></div></blockquote></div></small></div>Ty.denote</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type</var><b>: </b><span>Type 1</span></span></div></blockquote></div></small></div><span class="kt">Type</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token">    <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>fn</var><b>: </b><span>Ty → Ty → Ty</span></span></div></blockquote></div></small></div>fn</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"></div></span></pre><p>Here is the definition of the <code class="highlight coq"><span class="n">Term</span></code> type, including variables, constants, addition,
function application and abstraction, and let binding of local variables.
Since <code class="highlight coq"><span class="kr">let</span></code> is a keyword in Lean, we use the &quot;escaped identifier&quot; <code class="highlight coq"><span class="o">«</span><span class="kr">let</span><span class="o">»</span></code>.
You can input the unicode (French double quotes) using <code class="highlight coq"><span class="o">\</span><span class="n">f</span><span class="o">&lt;&lt;</span></code> (for <code class="highlight coq"><span class="o">«</span></code>) and <code class="highlight coq"><span class="o">\</span><span class="n">f</span><span class="o">&gt;&gt;</span></code> (for <code class="highlight coq"><span class="o">»</span></code>).
The term <code class="highlight coq"><span class="n">Term</span> <span class="n">ctx</span> <span class="o">.</span><span class="n">nat</span></code> is sugar for <code class="highlight coq"><span class="n">Term</span> <span class="n">ctx</span> <span class="n">Ty</span><span class="o">.</span><span class="n">nat</span></code>, Lean infers the namespace using the expected type.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div>Term</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type → Type</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Ty</div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type</var><b>: </b><span>Type 1</span></span></div></blockquote></div></small></div><span class="kt">Type</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>var</var><b>: </b><span>{ty : Ty} → {ctx : List Ty} → Member ty ctx → _root_.Term ctx ty</span></span></div></blockquote></div></small></div>var</div><div class="alectryon-token">   : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Member</var><b>: </b><span>{α : Type} → α → List α → Type</span></span></div></blockquote></div></small></div>Member</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → _root_.Term ctx Ty.nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>{ctx : List Ty} → _root_.Term ctx Ty.nat → _root_.Term ctx Ty.nat → _root_.Term ctx Ty.nat</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token">  : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>nat</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>app</var><b>: </b><span>{ctx : List Ty} → {dom ran : Ty} → _root_.Term ctx (Ty.fn dom ran) → _root_.Term ctx dom → _root_.Term ctx ran</span></span></div></blockquote></div></small></div>app</div><div class="alectryon-token">   : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.fn</var><b>: </b><span>Ty → Ty → Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>fn</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>dom</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">dom</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ran</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ran</span></div><div class="alectryon-token">) <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>dom</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">dom</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ran</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ran</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lam</var><b>: </b><span>{dom : Ty} → {ctx : List Ty} → {ran : Ty} → _root_.Term (dom :: ctx) ran → _root_.Term ctx (Ty.fn dom ran)</span></span></div></blockquote></div></small></div>lam</div><div class="alectryon-token">   : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>dom</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">dom</span></div><div class="alectryon-token"> :: </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ran</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ran</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.fn</var><b>: </b><span>Ty → Ty → Ty</span></span></div></blockquote></div></small></div><span class="bp">.</span>fn</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>dom</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">dom</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ran</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ran</span></div><div class="alectryon-token">)
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>«let»</var><b>: </b><span>{ctx : List Ty} → {ty₁ ty₂ : Ty} → _root_.Term ctx ty₁ → _root_.Term (ty₁ :: ctx) ty₂ → _root_.Term ctx ty₂</span></span></div></blockquote></div></small></div><span class="bp">«</span><span class="k">let</span><span class="bp">»</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty₁</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty₁</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty₁</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty₁</span></div><div class="alectryon-token"> :: </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty₂</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty₂</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div><span class="nv">Term</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty₂</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty₂</span></div><div class="alectryon-token"></div></span></pre><p>Here are two example terms encoding, the first addition packaged as a two-argument
curried function, and the second of a sample application of addition to constants.</p>
<p>The command <code class="highlight coq"><span class="n">open</span> <span class="n">Ty</span> <span class="n">Term</span> <span class="n">Member</span></code> opens the namespaces <code class="highlight coq"><span class="n">Ty</span></code>, <code class="highlight coq"><span class="n">Term</span></code>, and <code class="highlight coq"><span class="n">Member</span></code>. Thus,
you can write <code class="highlight coq"><span class="n">lam</span></code> instead of <code class="highlight coq"><span class="n">Term</span><span class="o">.</span><span class="n">lam</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kn">open</span></div><div class="alectryon-token"> Ty Term Member
</div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>add</var><b>: </b><span>Term [] (fn nat (fn nat nat))</span></span></div></blockquote></div></small></div>add</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div>Term</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>[]</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div>[]</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>fn</var><b>: </b><span>Ty → Ty → Ty</span></span></div></blockquote></div></small></div>fn</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>fn</var><b>: </b><span>Ty → Ty → Ty</span></span></div></blockquote></div></small></div>fn</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token">)) :=
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lam</var><b>: </b><span>{dom : Ty} → {ctx : List Ty} → {ran : Ty} → Term (dom :: ctx) ran → Term ctx (fn dom ran)</span></span></div></blockquote></div></small></div>lam</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lam</var><b>: </b><span>{dom : Ty} → {ctx : List Ty} → {ran : Ty} → Term (dom :: ctx) ran → Term ctx (fn dom ran)</span></span></div></blockquote></div></small></div>lam</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>{ctx : List Ty} → Term ctx nat → Term ctx nat → Term ctx nat</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>var</var><b>: </b><span>{ty : Ty} → {ctx : List Ty} → Member ty ctx → Term ctx ty</span></span></div></blockquote></div></small></div>var</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>tail</var><b>: </b><span>{x : Type} → {a : x} → {bs : List x} → {b : x} → Member a bs → Member a (b :: bs)</span></span></div></blockquote></div></small></div>tail</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>head</var><b>: </b><span>{x : Type} → {a : x} → {as : List x} → Member a (a :: as)</span></span></div></blockquote></div></small></div>head</div><div class="alectryon-token">)) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>var</var><b>: </b><span>{ty : Ty} → {ctx : List Ty} → Member ty ctx → Term ctx ty</span></span></div></blockquote></div></small></div>var</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>head</var><b>: </b><span>{x : Type} → {a : x} → {as : List x} → Member a (a :: as)</span></span></div></blockquote></div></small></div>head</div><div class="alectryon-token">)))

</div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>three_the_hard_way</var><b>: </b><span>Term [] nat</span></span></div></blockquote></div></small></div>three_the_hard_way</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div>Term</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>[]</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div>[]</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>nat</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div>nat</div><div class="alectryon-token"> :=
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>app</var><b>: </b><span>{ctx : List Ty} → {dom ran : Ty} → Term ctx (fn dom ran) → Term ctx dom → Term ctx ran</span></span></div></blockquote></div></small></div>app</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>app</var><b>: </b><span>{ctx : List Ty} → {dom ran : Ty} → Term ctx (fn dom ran) → Term ctx dom → Term ctx ran</span></span></div></blockquote></div></small></div>app</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>add</var><b>: </b><span>Term [] (fn nat (fn nat nat))</span></span></div></blockquote></div></small></div>add</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>1</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">1</span></div><div class="alectryon-token">)) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>2</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">2</span></div><div class="alectryon-token">)</div></span></pre><p>Since dependent typing ensures that any term is well-formed in its context and has a particular type,
it is easy to translate syntactic terms into Lean values.</p>
<p>The attribute <code class="highlight coq"><span class="o">[</span><span class="n">simp</span><span class="o">]</span></code> instructs Lean to always try to unfold <code class="highlight coq"><span class="n">Term</span><span class="o">.</span><span class="n">denote</span></code> applications when one applies
the <code class="highlight coq"><span class="n">simp</span></code> tactic. We also say this is a hint for the Lean term simplifier.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">@</span>[</div><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token">] </div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term.denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div>Term.denote</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div>Term</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>HList</var><b>: </b><span>{α : Type} → (α → Type) → List α → Type</span></span></div></blockquote></div></small></div>HList</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Ty.denote</var><b>: </b><span>Ty → Type</span></span></div></blockquote></div></small></div>Ty.denote</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>Ty → Type</span></span></div></blockquote></div></small></div>denote</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>var</var><b>: </b><span>{ty : Ty} → {ctx : List Ty} → Member ty ctx → Term ctx ty</span></span></div></blockquote></div></small></div>var</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Member ?ty ctx</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token">,     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>get</var><b>: </b><span>{x : Type} → {β : x → Type} → {is : List x} → {i : x} → HList β is → Member i is → β i</span></span></div></blockquote></div></small></div>get</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Member ty ctx</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>n</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">n</span></div><div class="alectryon-token">,   </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>_</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div>_</div><div class="alectryon-token">   <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>n</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">n</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>{ctx : List Ty} → Term ctx nat → Term ctx nat → Term ctx nat</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">,  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> <span class="bp">+</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>app</var><b>: </b><span>{ctx : List Ty} → {dom ran : Ty} → Term ctx (fn dom ran) → Term ctx dom → Term ctx ran</span></span></div></blockquote></div></small></div>app</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>f</var><b>: </b><span>Term ctx (fn ?m.9167 ?ty)</span></span></div></blockquote></div></small></div><span class="nv">f</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx ?m.9167</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token">,   </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>f</var><b>: </b><span>Term ctx (fn x✝ ty)</span></span></div></blockquote></div></small></div><span class="nv">f</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx x✝</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token">)
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lam</var><b>: </b><span>{dom : Ty} → {ctx : List Ty} → {ran : Ty} → Term (dom :: ctx) ran → Term ctx (fn dom ran)</span></span></div></blockquote></div></small></div>lam</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (?m.9243 :: ctx) ?m.9244</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">,     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><span class="k">fun</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>x</var><b>: </b><span>Ty.denote x✝¹</span></span></div></blockquote></div></small></div><span class="nv">x</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (x✝¹ :: ctx) x✝</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>x</var><b>: </b><span>Ty.denote x✝¹</span></span></div></blockquote></div></small></div><span class="nv">x</span></div><div class="alectryon-token"> :: </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token">)
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>«let»</var><b>: </b><span>{ctx : List Ty} → {ty₁ ty₂ : Ty} → Term ctx ty₁ → Term (ty₁ :: ctx) ty₂ → Term ctx ty₂</span></span></div></blockquote></div></small></div><span class="bp">«</span><span class="k">let</span><span class="bp">»</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx ?m.9474</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (?m.9474 :: ctx) ?ty</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (x✝ :: ctx) ty</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx x✝</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div><span class="nv">denote</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> :: </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token">)</div></span></pre><p>You can show that the denotation of <code class="highlight coq"><span class="n">three_the_hard_way</span></code> is indeed <code class="highlight coq"><span class="mi">3</span></code> using reflexivity.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>example</var><b>: </b><span>Term.denote three_the_hard_way [] = 3</span></span></div></blockquote></div></small></div><span class="kd">example</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>three_the_hard_way</var><b>: </b><span>Term [] nat</span></span></div></blockquote></div></small></div>three_the_hard_way</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div>denote</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>[]</var><b>: </b><span>HList Ty.denote []</span></span></div></blockquote></div></small></div>[]</div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>3</var><b>: </b><span>Ty.denote nat</span></span></div></blockquote></div></small></div><span class="mi">3</span></div><div class="alectryon-token"> :=
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>rfl</var><b>: </b><span>∀ {α : Type} {a : α}, a = a</span></span></div></blockquote></div></small></div>rfl</div><div class="alectryon-token"></div></span></pre><p>We now define the constant folding optimization that traverses a term if replaces subterms such as
<code class="highlight coq"><span class="n">plus</span> <span class="o">(</span><span class="n">const</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">const</span> <span class="n">n</span><span class="o">)</span></code> with <code class="highlight coq"><span class="n">const</span> <span class="o">(</span><span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">)</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">@</span>[</div><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token">] </div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term.constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div>Term.constFold</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div>Term</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token"> <span class="bp">→</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div>Term</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>n</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">n</span></div><div class="alectryon-token">   <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>n</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">n</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>var</var><b>: </b><span>{ty : Ty} → {ctx : List Ty} → Member ty ctx → Term ctx ty</span></span></div></blockquote></div></small></div>var</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Member ?ty ctx</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token">     <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>var</var><b>: </b><span>{ty : Ty} → {ctx : List Ty} → Member ty ctx → Term ctx ty</span></span></div></blockquote></div></small></div>var</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>Member ty ctx</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>app</var><b>: </b><span>{ctx : List Ty} → {dom ran : Ty} → Term ctx (fn dom ran) → Term ctx dom → Term ctx ran</span></span></div></blockquote></div></small></div>app</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>f</var><b>: </b><span>Term ctx (fn ?m.15407 ?ty)</span></span></div></blockquote></div></small></div><span class="nv">f</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx ?m.15407</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token">   <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>app</var><b>: </b><span>{ctx : List Ty} → {dom ran : Ty} → Term ctx (fn dom ran) → Term ctx dom → Term ctx ran</span></span></div></blockquote></div></small></div>app</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>f</var><b>: </b><span>Term ctx (fn x✝ ty)</span></span></div></blockquote></div></small></div><span class="nv">f</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">constFold</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx x✝</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">constFold</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lam</var><b>: </b><span>{dom : Ty} → {ctx : List Ty} → {ran : Ty} → Term (dom :: ctx) ran → Term ctx (fn dom ran)</span></span></div></blockquote></div></small></div>lam</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (?m.15455 :: ctx) ?m.15456</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">     <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lam</var><b>: </b><span>{dom : Ty} → {ctx : List Ty} → {ran : Ty} → Term (dom :: ctx) ran → Term ctx (fn dom ran)</span></span></div></blockquote></div></small></div>lam</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (x✝¹ :: ctx) x✝</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">constFold</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>«let»</var><b>: </b><span>{ctx : List Ty} → {ty₁ ty₂ : Ty} → Term ctx ty₁ → Term (ty₁ :: ctx) ty₂ → Term ctx ty₂</span></span></div></blockquote></div></small></div><span class="bp">«</span><span class="k">let</span><span class="bp">»</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx ?m.15500</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (?m.15500 :: ctx) ?ty</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>«let»</var><b>: </b><span>{ctx : List Ty} → {ty₁ ty₂ : Ty} → Term ctx ty₁ → Term (ty₁ :: ctx) ty₂ → Term ctx ty₂</span></span></div></blockquote></div></small></div><span class="bp">«</span><span class="k">let</span><span class="bp">»</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx x✝</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">constFold</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term (x✝ :: ctx) ty</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">constFold</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>{ctx : List Ty} → Term ctx nat → Term ctx nat → Term ctx nat</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token">  <span class="bp">=&gt;</span>
    </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">a</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">constFold</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">constFold</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>n</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">n</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>m</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">m</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>const</var><b>: </b><span>{ctx : List Ty} → Nat → Term ctx nat</span></span></div></blockquote></div></small></div>const</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>n</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">n</span></div><div class="alectryon-token"><span class="bp">+</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>m</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">m</span></div><div class="alectryon-token">)
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a'</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">a&#39;</span></div><div class="alectryon-token">,      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b'</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">b&#39;</span></div><div class="alectryon-token">      <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>plus</var><b>: </b><span>{ctx : List Ty} → Term ctx nat → Term ctx nat → Term ctx nat</span></span></div></blockquote></div></small></div>plus</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>a'</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">a&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b'</var><b>: </b><span>Term ctx nat</span></span></div></blockquote></div></small></div><span class="nv">b&#39;</span></div><div class="alectryon-token"></div></span></pre><p>The correctness of the <code class="highlight coq"><span class="n">Term</span><span class="o">.</span><span class="n">constFold</span></code> is proved using induction, case-analysis, and the term simplifier.
We prove all cases but the one for <code class="highlight coq"><span class="n">plus</span></code> using <code class="highlight coq"><span class="n">simp</span> <span class="o">[*]</span></code>. This tactic instructs the term simplifier to
use hypotheses such as <code class="highlight coq"><span class="n">a</span> <span class="o">=</span> <span class="n">b</span></code> as rewriting/simplications rules.
We use the <code class="highlight coq"><span class="nb">split</span></code> to break the nested <code class="highlight coq"><span class="kr">match</span></code> expression in the <code class="highlight coq"><span class="n">plus</span></code> case into two cases.
The local variables <code class="highlight coq"><span class="n">iha</span></code> and <code class="highlight coq"><span class="n">ihb</span></code> are the induction hypotheses for <code class="highlight coq"><span class="n">a</span></code> and <code class="highlight coq"><span class="n">b</span></code>.
The modifier <code class="highlight coq"><span class="o">←</span></code> in a term simplifier argument instructs the term simplier to use the equation as a rewriting rule in
the &quot;reverse direction. That is, given <code class="highlight coq"><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">b</span></code>, <code class="highlight coq"><span class="o">←</span> <span class="n">h</span></code> instructs the term simplifier to rewrite <code class="highlight coq"><span class="n">b</span></code> subterms to <code class="highlight coq"><span class="n">a</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term.constFold_sound</var><b>: </b><span>∀ {ctx : List Ty} {ty : Ty} {env : HList Ty.denote ctx} (e : Term ctx ty), denote (constFold e) env = denote e env</span></span></div></blockquote></div></small></div>Term.constFold_sound</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Term</var><b>: </b><span>List Ty → Ty → Type</span></span></div></blockquote></div></small></div>Term</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ctx</var><b>: </b><span>List Ty</span></span></div></blockquote></div></small></div><span class="nv">ctx</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ty</var><b>: </b><span>Ty</span></span></div></blockquote></div></small></div><span class="nv">ty</span></div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>constFold</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → Term ctx ty</span></span></div></blockquote></div></small></div>constFold</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div>denote</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>denote</var><b>: </b><span>{ctx : List Ty} → {ty : Ty} → Term ctx ty → HList Ty.denote ctx → Ty.denote ty</span></span></div></blockquote></div></small></div>denote</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>env</var><b>: </b><span>HList Ty.denote ctx</span></span></div></blockquote></div></small></div><span class="nv">env</span></div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk0"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Term ctx ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">denote (constFold e) env <span class="bp">=</span> denote e env</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk1"><div class="alectryon-token"><span class="k">induction</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Term ctx ty</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Term ctx ty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">denote (constFold e) env <span class="bp">=</span> denote e env</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk2"><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token"> [<span class="bp">*</span>]</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk3"><div class="alectryon-token"><span class="bp">|</span> plus a b iha ihb <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>ctx✝</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold a) env <span class="bp">=</span> denote a env</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold b) env <span class="bp">=</span> denote b env</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx<span class="bp">✝</span></span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus</span></span><div class="goal-conclusion">denote
    (<span class="k">match</span> constFold a, constFold b <span class="k">with</span>
    <span class="bp">|</span> const n, const m <span class="bp">=&gt;</span> const (n <span class="bp">+</span> m)
    <span class="bp">|</span> a&#39;, b&#39; <span class="bp">=&gt;</span> plus a&#39; b&#39;)
    env <span class="bp">=</span>
  denote a env <span class="bp">+</span> denote b env</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk4"><div class="alectryon-token"><span class="k">split</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>ctx✝</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold a) env <span class="bp">=</span> denote a env</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold b) env <span class="bp">=</span> denote b env</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx<span class="bp">✝</span></span></span></span><br><span><var>x✝¹, x✝</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>n✝, m✝</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_1</span></span><div class="goal-conclusion">denote (const (n<span class="bp">✝</span> <span class="bp">+</span> m<span class="bp">✝</span>)) env <span class="bp">=</span> denote a env <span class="bp">+</span> denote b env</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>ctx✝</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold a) env <span class="bp">=</span> denote a env</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold b) env <span class="bp">=</span> denote b env</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx<span class="bp">✝</span></span></span></span><br><span><var>x✝², x✝¹</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br></div><label class="goal-separator" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk5"><hr><span class="goal-name">plus.h_2</span></label><div class="goal-conclusion">denote (plus (constFold a) (constFold b)) env <span class="bp">=</span> denote a env <span class="bp">+</span> denote b env</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk6"><div class="alectryon-token"><span class="k">next</span></div><div class="alectryon-token"> he₁ he₂ <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>ctx✝</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold a) env <span class="bp">=</span> denote a env</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold b) env <span class="bp">=</span> denote b env</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx<span class="bp">✝</span></span></span></span><br><span><var>x✝¹, x✝</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>n✝, m✝</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_1</span></span><div class="goal-conclusion">denote (const (n<span class="bp">✝</span> <span class="bp">+</span> m<span class="bp">✝</span>)) env <span class="bp">=</span> denote a env <span class="bp">+</span> denote b env</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>ctx✝</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold a) env <span class="bp">=</span> denote a env</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold b) env <span class="bp">=</span> denote b env</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx<span class="bp">✝</span></span></span></span><br><span><var>x✝², x✝¹</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br></div><label class="goal-separator" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk7"><hr><span class="goal-name">plus.h_2</span></label><div class="goal-conclusion">denote (plus (constFold a) (constFold b)) env <span class="bp">=</span> denote a env <span class="bp">+</span> denote b env</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk8"><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token"> [<span class="bp">←</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>∀ {env : HList Ty.denote ctx✝}, denote (constFold a) env = denote a env</span></span></div></blockquote></div></small></div><span class="nv">iha</span></div><div class="alectryon-token">, <span class="bp">←</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>∀ {env : HList Ty.denote ctx✝}, denote (constFold b) env = denote b env</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>he₁</var><b>: </b><span>constFold a = const n✝</span></span></div></blockquote></div></small></div><span class="nv">he₁</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>he₂</var><b>: </b><span>constFold b = const m✝</span></span></div></blockquote></div></small></div><span class="nv">he₂</span></div><div class="alectryon-token">]</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chk9"><div class="alectryon-token"><span class="k">next</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ctx</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>ty</var><span class="hyp-type"><b>: </b><span>Ty</span></span></span><br><span><var>ctx✝</var><span class="hyp-type"><b>: </b><span>List Ty</span></span></span><br><span><var>a, b</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br><span><var>iha</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold a) env <span class="bp">=</span> denote a env</span></span></span><br><span><var>ihb</var><span class="hyp-type"><b>: </b><span><span class="bp">∀</span> {env : HList Ty.denote ctx<span class="bp">✝</span>}, denote (constFold b) env <span class="bp">=</span> denote b env</span></span></span><br><span><var>env</var><span class="hyp-type"><b>: </b><span>HList Ty.denote ctx<span class="bp">✝</span></span></span></span><br><span><var>x✝², x✝¹</var><span class="hyp-type"><b>: </b><span>Term ctx<span class="bp">✝</span> nat</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">plus.h_2</span></span><div class="goal-conclusion">denote (plus (constFold a) (constFold b)) env <span class="bp">=</span> denote a env <span class="bp">+</span> denote b env</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="j0nhn2zyw601mwvk7yhpv6ybdlrncqm-debruijn-lean-chka"><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token"> [</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>iha</var><b>: </b><span>∀ {env : HList Ty.denote ctx✝}, denote (constFold a) env = denote a env</span></span></div></blockquote></div></small></div><span class="nv">iha</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihb</var><b>: </b><span>∀ {env : HList Ty.denote ctx✝}, denote (constFold b) env = denote b env</span></span></div></blockquote></div></small></div><span class="nv">ihb</span></div><div class="alectryon-token">]</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">🐙</span></div></blockquote></div></div></small></span></pre>
</div>
</div></body>
</html>
